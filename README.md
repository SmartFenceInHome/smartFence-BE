# smartFence-BE

이 프로젝트는 YOLO 모델을 활용해 반려동물, 어린아이를 감지하고 초음파 센서를 통해 거리 정보를 측정한 결과를 토대로 서보 모터로 문을 제어하는 시스템입니다.
또한 이 결과를 사용자가 볼 수 있게끔 웹페이지에 데이터를 실시간으로 확인할 수 있게 하며 스마트 펜스 열고 닫기가 원격으로 가능하도록 하였습니다.

## 목차
1. [프로젝트 개요](#프로젝트-개요)
2. [필요한 구성 요소](#필요한-구성-요소)
3. [설치 및 실행](#설치-및-실행)
4. [시스템 구성](#시스템-구성)
5. [사용 방법](#사용-방법)
6. [주요 기능](#주요-기능)
7. [에러 처리 및 디버깅](#에러-처리-및-디버깅)

---

## 프로젝트 개요

이 프로젝트는 초음파 센서, 서보 모터, 카메라 모듈, 그리고 Raspberry Pi를 활용하여 다음 기능을 수행합니다:
- 객체를 감지하고 감지된 객체의 정보를 실시간으로 클라이언트에 전송.
- YOLOv8 모델을 활용하여 객체 감지 및 분류를 수행.
- 감지된 객체가 일정 거리 이내로 접근 시 서보 모터로 문을 닫음
- 클라이언트가 웹페이지에서 펜스를 원격으로 열고 닫을 수 있음.

---

## 필요한 구성 요소

1. **하드웨어**:
   - Raspberry Pi (Raspberry Pi OS 설치)
   - 초음파 센서 (HC-SR04)
   - 서보 모터 (PWM 제어 가능)
   - Raspberry Pi 카메라 모듈
   - GPIO 핀 및 연결 케이블

2. **소프트웨어 및 라이브러리**:
   - Python 3.x
   - Flask (`pip install flask`)
   - Python SocketIO (`pip install python-socketio`)
   - OpenCV (`pip install opencv-python`)
   - Ultralytics YOLO (`pip install ultralytics`)
   - 기타 의존성 (아래 설치 방법 참조)

---

## 설치 및 실행

### 1. 프로젝트 클론 및 설치
git clone https://github.com/your-repo/project-name.git
cd project-name
python yolo.py
python app.py

--

## 시스템 구성 

1. app.py
  - 카메라 스트리밍 및 YOLO 감지 요청 (카메라로 캡처한 이미지 YOLO 서버로 전송해 객체 감지 수행)
  - 객체 감지와 초음파 센서로 측정된 거리에 따라 서보 모터 제어(펜스 닫음)
  - Socket.IO 통신 (클라이언트와 실시간 데이터 교환 (거리, 객체 감지 상태 ..))

2. yolo.py
  - YOLOv8 모델 사용해 이미지에서 객체를 감지하고 분류
  - COCO 및 사용자 정의 클래스 감지
  - 정확도 통계 (감지된 객체의 클래스별 정확도 계산하고 로그 출력)

--

## 사용 방법

1. Raspberry Pi를 설정하고 초음파 센서, 서보 모터, 카메라 모듈을 연결합니다.
2. YOLO 서버와 Raspberry Pi 제어 앱을 각각 실행합니다.
3. 웹 클라이언트를 통해 실시간 데이터를 확인하거나 서보 모터를 원격으로 제어합니다.

--

## 주요 기능

1. 객체 탐지
   - YOLO 모델 사용해 실시간으로 객체를 감지하고 정보를 전송합니다.
   - 사용자 정의 모델로 노약자 및 아기 감지를 지원합니다.
2. 거리 감지
   - 초음파 센서를 통해 객체와 펜스 간의 거리를 감지합니다.
3. 서보 모터 제어
   - 위의 두 가지 조건을 모두 만족하면 서보 모터를 제어해 펜스를 닫습니다.
4. 실시간 데이터 스트리밍
   - 카메라 이미지와 초음파 센서 데이터를 Socket.IO를 통해 실시간으로 제공합니다.
5. 정확도 통계
    - 감지된 객체의 클래스별 정확도를 계산해 로그로 출력합니다.
  
--

## 에러 처리 및 디버깅

1. 서버 연결 문제
  - YOLO 서버 연결 오류 발생 시, IP 주소와 포트 설정을 확인하세요.
  - 타임아웃 오류 발생 시 네트워크 상태를 점검하세요.
2. 초음파 센서 오류
  - 거리가 항상 -1로 표시될 경우 배선과 GPIO 핀 설정을 확인하세요.
  - 초음파 센서의 사양에 따라 거리 범위를 조정할 수 있습니다.
3. 서보 모터 동작 문제
  - 서보 모터가 회전하지 않을 경우 GPIO 핀 배치 및 전원 연결을 확인하세요.
  - PWM 설정 값이 서보 모터 사양에 맞는지 확인하세요.


